"use strict";angular.module("weatherAnalytics",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","mgcrea.ngStrap"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/apis",{templateUrl:"views/apis.html",controller:"ApisCtrl"}).when("/contact",{templateUrl:"views/contact.html",controller:"ContactCtrl"}).when("/logs",{templateUrl:"views/product-logs.html",controller:"LogsCtrl"}).when("/history",{templateUrl:"views/history.html",controller:"HistoryCtrl"}).when("/forecast",{templateUrl:"views/forecast.html",controller:"ForecastCtrl"}).otherwise({templateUrl:"views/404.html",controller:"ErrorCtrl"})}]).run(["$rootScope","notificationsService",function(a,b){a.$on("$routeChangeStart",function(){b.stopLoading(),b.removeMessage()})}]),angular.module("weatherAnalytics").controller("IndexCtrl",["$scope","pageService","messagesService",function(a,b,c){b.setApplicationName(c.get("TITLE_APPLICATION")),a.page=b,a.tooltipGithub={title:c.get("MESSAGE_SOCIAL_GITHUB")},a.tooltipBitBucket={title:c.get("MESSAGE_SOCIAL_BITBUCKET")},a.tooltipYoutube={title:c.get("MESSAGE_SOCIAL_YOUTUBE")},a.tooltipLinkedin={title:c.get("MESSAGE_SOCIAL_LINKEDIN")},a.tooltipWebsite={title:c.get("MESSAGE_SOCIAL_WEBSITE")},a.headerIn=!1,a.headerClick=function(){a.headerIn=!a.headerIn}}]),angular.module("weatherAnalytics").controller("MainCtrl",["$scope","pageService","messagesService",function(a,b,c){b.setPageName(c.get("TITLE_PAGE_MAIN"))}]),angular.module("weatherAnalytics").controller("AboutCtrl",["$scope","pageService","messagesService",function(a,b,c){b.setPageName(c.get("TITLE_PAGE_ABOUT"))}]),angular.module("weatherAnalytics").controller("ApisCtrl",["$scope","pageService","messagesService",function(a,b,c){b.setPageName(c.get("TITLE_PAGE_APIS"))}]),angular.module("weatherAnalytics").controller("ContactCtrl",["$scope","pageService","messagesService",function(a,b,c){b.setPageName(c.get("TITLE_PAGE_CONTACT"))}]),angular.module("weatherAnalytics").controller("ErrorCtrl",["$scope","pageService","messagesService",function(a,b,c){b.setPageName(c.get("TITLE_PAGE_ERROR"))}]),angular.module("weatherAnalytics").controller("NotificationsCtrl",["$scope","notificationsService",function(a,b){a.notifications=b}]),angular.module("weatherAnalytics").controller("LogsCtrl",["$scope","pageService","exceptionLogger","messagesService",function(a,b,c,d){b.setPageName(d.get("TITLE_PAGE_LOGS")),a.content=d.get("MESSAGE_LOGS_EMPTY"),a.reload=function(){var b=c.getLogs();a.content=b&&""!==b?b:d.get("MESSAGE_LOGS_EMPTY")},a.clear=function(){c.clearLogs(),a.reload()},a.reload()}]),angular.module("weatherAnalytics").controller("HistoryCtrl",["$scope","pageService","messagesService",function(a,b,c){b.setPageName(c.get("TITLE_PAGE_HISTORY"))}]),angular.module("weatherAnalytics").controller("ForecastCtrl",["$scope","$filter","$location","$route","pageService","messagesService","apiCallerService",function(a,b,c,d,e,f,g){var h,i,j="Metric",k="Imperial";a.cities=[],a.selectedCity=void 0,a.units=[{type:j,name:f.get("MESSAGE_FORECAST_UNIT_METRIC")},{type:k,name:f.get("MESSAGE_FORECAST_UNIT_IMPERIAL")}],a.selectedUnit=void 0,a.forecast={};var l=function(){a.selectedCity&&c.search({city:a.selectedCity.name,country:a.selectedCity.country,unit:a.selectedUnit.type})},m=function(){var b=c.search();if(b.city&&b.country&&(h=b.city,i=b.country),b.unit)for(var d=0;d<a.units.length;d++)b.unit===a.units[d].type&&(a.selectedUnit=a.units[d]);a.selectedUnit||(a.selectedUnit=a.units[0])},n=function(b){b&&(a.cities=b.cities),a.cities.forEach(function(b){b.name===h&&b.country===i&&(a.selectedCity=b)})},o=function(){a.selectedCity&&a.selectedCity.name&&a.selectedCity.country&&(l(),g.get(a,"/api/forecast/"+a.selectedCity.name+"/"+a.selectedCity.country,g.API_CONSTANTS.SUCCESS,p))},p=function(b){a.forecast=b.forecast},q=function(){a.selectedUnit&&l()},r=function(a){return a||0===a?a:"?"};a.getDayofWeek=function(a){return b("date")(new Date(a.date),"EEEE, dd")},a.getTemperatureMax=function(b){return b.temperatureMax?a.selectedUnit&&a.selectedUnit.type===k?r(b.temperatureMax.fahrenheit)+"째F":r(b.temperatureMax.celsius)+"째C":"?"},a.getTemperatureMin=function(b){return b.temperatureMax?a.selectedUnit&&a.selectedUnit.type===k?r(b.temperatureMin.fahrenheit)+"째F":r(b.temperatureMin.celsius)+"째C":"?"},a.getPrecipitation=function(a){return r(a.precipitation)},a.getWindSpeed=function(b){return b.windSpeed?a.selectedUnit&&a.selectedUnit.type===k?r(b.windSpeed.mph)+" mph":r(b.windSpeed.kmph)+" km/h":"?"},a.getDirectionDay=function(a){return a.windDirection?Math.round(a.windDirection/45):0},e.setPageName(f.get("TITLE_PAGE_FORECAST")),m();var s=d.current;a.$on("$locationChangeSuccess",function(){d.current.$$route&&"ForecastCtrl"===d.current.$$route.controller&&(d.current=s,m(),n())}),g.watchDestroyed(a),a.$watch("selectedCity",o),a.$watch("selectedUnit",q),g.get(a,"/api/cities",g.API_CONSTANTS.SUCCESS,n)}]),angular.module("weatherAnalytics").service("pageService",function(){this.applicationName=void 0,this.pageName=void 0,this.loading=!1,this.setApplicationName=function(a){this.applicationName=a},this.setPageName=function(a){this.pageName=a},this.getTitle=function(){var a="";return this.pageName&&(a+=this.pageName),this.pageName&&this.applicationName&&(a+=" - "),this.applicationName&&(a+=this.applicationName),a}}),angular.module("weatherAnalytics").service("notificationsService",["$timeout",function(a){this.MESAGE_TYPE={NONE:0,INFO:1,ERROR:2},this.message=void 0,this.type=this.MESAGE_TYPE.NONE,this.loading=!1,this.stopLoadingPending=!1,this.isLoading=function(){return this.loading},this.startLoading=function(){this.loading=!0,this.stopLoadingPending=!1,this.message=void 0,this.type=this.MESAGE_TYPE.NONE},this.stopLoading=function(){if(this.stopLoadingPending=!0,this.loading){var b=this;a(function(){b.stopLoadingPending&&(b.loading=!1)},100)}},this.isInfo=function(){return this.type===this.MESAGE_TYPE.INFO},this.isError=function(){return this.type===this.MESAGE_TYPE.ERROR},this.getMessage=function(){return this.message},this.addInfo=function(a){this.message=a,this.type=this.MESAGE_TYPE.INFO,this.loading=!1},this.addError=function(a){this.message=a,this.type=this.MESAGE_TYPE.ERROR,this.loading=!1},this.removeMessage=function(){this.message=void 0,this.type=this.MESAGE_TYPE.NONE}}]),angular.module("weatherAnalytics").service("apiCallerService",["$http","notificationsService","exceptionLogger","messagesService",function(a,b,c,d){this.API_CONSTANTS={UNKNOWN:0,SUCCESS:1,PROCESSING:2,ERROR_UNKNOWN:100,ERROR_API_NOT_FOUND:110,ERROR_PARAMETER_MISSING:120,ERROR_PARAMETER_WRONG_VALUE:121},this.watchDestroyed=function(a){a.$on("$destroy",function(){a.destroyed=!0})},this.handleError=function(a){var e="";e=a.result&&a.message?d.get("MESSAGE_API_SPECIFIC_ERROR")+a.message:d.get("MESSAGE_API_UNKNOWN_ERROR"),b.addError(e),c.handleError(e)},this.get=function(e,f,g,h,i){var j=this;b.startLoading();try{a.get(f).success(function(a){if(!e.destroyed){if(!a.result||a.result!==g)return void i(a,200);b.stopLoading(),h&&h(a)}}).error(function(a,c){e.destroyed||(b.stopLoading(),i?i(a,c):j.handleError(a,c))})}catch(k){b.addError(d.get("MESSAGE_API_UNKNOWN_ERROR")),c.handleError(d.get("MESSAGE_API_UNKNOWN_ERROR_LOG"),k)}}}]),angular.module("weatherAnalytics").factory("$exceptionHandler",function(){return function(a){try{console.error("Uncatched exception"+a.stack)}catch(b){console.error("Uncatched exception"+a)}try{ErrorLogger.getInstance().handleError("Uncatched exception",a,!0)}catch(b){console.error("Cannot log error message: "+b.stack)}}}).service("exceptionLogger",function(){var a;try{a=ErrorLogger.getInstance()}catch(b){console.error("Cannot load error logger: "+b.stack)}return{handleError:function(b,c,d){a&&a.handleError(b,c,d)},getLogs:function(){return a?a.getLogs():void 0},clearLogs:function(){return a?a.clearLogs():void 0}}}),angular.module("weatherAnalytics").service("messagesService",[function(){var a={TITLE_APPLICATION:"Weather Analytics",TITLE_PAGE_ABOUT:"About",TITLE_PAGE_CONTACT:"Contact",TITLE_PAGE_ERROR:"Error",TITLE_PAGE_MAIN:"Main",TITLE_PAGE_LOGS:"Logs",TITLE_PAGE_HISTORY:"History",TITLE_PAGE_FORECAST:"Forecast",TITLE_PAGE_APIS:"APIs",MESSAGE_SOCIAL_GITHUB:"Visit my Github",MESSAGE_SOCIAL_BITBUCKET:"Visit my BitBucket",MESSAGE_SOCIAL_YOUTUBE:"Visit my Youtube channel",MESSAGE_SOCIAL_LINKEDIN:"Check me on Linkedin",MESSAGE_SOCIAL_WEBSITE:"Visit my website",MESSAGE_LOGS_EMPTY:"There are no errors to show",MESSAGE_API_UNKNOWN_ERROR:"An unknown error occurred during the current operation",MESSAGE_API_UNKNOWN_ERROR_LOG:"An unknown error occurred during an API request",MESSAGE_API_SPECIFIC_ERROR:"The following error occurred during the current operation: ",MESSAGE_FORECAST_UNIT_METRIC:"Metric",MESSAGE_FORECAST_UNIT_IMPERIAL:"Imperial"};this.get=function(b){var c=a[b];return c?c:b}}]);